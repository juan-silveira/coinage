{
  "info": {
    "name": "üìß Email Templates & Confirmation",
    "description": "Endpoints para confirma√ß√£o de email, templates e notifica√ß√µes por email",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "version": "1.0.0"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "{{base_url}}",
      "type": "string"
    },
    {
      "key": "access_token",
      "value": "{{access_token}}",
      "type": "string"
    },
    {
      "key": "email_token",
      "value": "{{email_token}}",
      "type": "string"
    },
    {
      "key": "test_email",
      "value": "{{test_email}}",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "‚úÖ Confirm Email",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/email-confirmation/confirm?token={{email_token}}&company=default",
          "host": ["{{base_url}}"],
          "path": ["api", "email-confirmation", "confirm"],
          "query": [
            {
              "key": "token",
              "value": "{{email_token}}"
            },
            {
              "key": "company",
              "value": "default"
            }
          ]
        },
        "description": "Confirma o email do usu√°rio usando token de confirma√ß√£o"
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Email confirmed successfully\", function () {",
              "    const response = pm.response.json();",
              "    pm.expect(response).to.have.property('success');",
              "    pm.expect(response.success).to.be.true;",
              "});",
              "",
              "console.log('‚úÖ Email Confirmation - Status:', pm.response.json().message);"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "üì§ Resend Confirmation Email",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{access_token}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"{{test_email}}\",\n  \"companyAlias\": \"default\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/email-confirmation/resend",
          "host": ["{{base_url}}"],
          "path": ["api", "email-confirmation", "resend"]
        },
        "description": "Reenvia email de confirma√ß√£o para usu√°rio"
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Email resent successfully\", function () {",
              "    const response = pm.response.json();",
              "    pm.expect(response).to.have.property('success');",
              "    pm.expect(response.success).to.be.true;",
              "});",
              "",
              "console.log('‚úÖ Email Resent - Status:', pm.response.json().message);"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "üìä Get Email Status",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{access_token}}"
          }
        ],
        "url": {
          "raw": "{{base_url}}/api/email-confirmation/status/{{user_id}}",
          "host": ["{{base_url}}"],
          "path": ["api", "email-confirmation", "status", "{{user_id}}"]
        },
        "description": "Verifica status de confirma√ß√£o de email do usu√°rio"
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response has email status\", function () {",
              "    const response = pm.response.json();",
              "    pm.expect(response).to.have.property('success');",
              "    pm.expect(response.data).to.have.property('emailConfirmed');",
              "});",
              "",
              "console.log('‚úÖ Email Status - Confirmed:', pm.response.json().data?.emailConfirmed);"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "üìß Test Welcome Email",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{access_token}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"template\": \"welcome\",\n  \"to\": \"{{test_email}}\",\n  \"data\": {\n    \"name\": \"Jo√£o Silva\",\n    \"companyName\": \"Coinage\"\n  }\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/email/send-template",
          "host": ["{{base_url}}"],
          "path": ["api", "email", "send-template"]
        },
        "description": "Testa template de email de boas-vindas"
      },
      "response": []
    },
    {
      "name": "üîê Test Login Alert Email",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{access_token}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"template\": \"login-alert\",\n  \"to\": \"{{test_email}}\",\n  \"data\": {\n    \"name\": \"Jo√£o Silva\",\n    \"loginTime\": \"2024-08-19 17:30:00\",\n    \"ipAddress\": \"192.168.1.100\",\n    \"userAgent\": \"Chrome/127.0.0.0\"\n  }\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/email/send-template",
          "host": ["{{base_url}}"],
          "path": ["api", "email", "send-template"]
        },
        "description": "Testa template de email de alerta de login"
      },
      "response": []
    },
    {
      "name": "üí∞ Test Deposit Confirmed Email",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{access_token}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"template\": \"deposit-confirmed\",\n  \"to\": \"{{test_email}}\",\n  \"data\": {\n    \"name\": \"Jo√£o Silva\",\n    \"amount\": \"100.00\",\n    \"currency\": \"cBRL\",\n    \"transactionId\": \"TXN123456789\",\n    \"timestamp\": \"2024-08-19 17:30:00\"\n  }\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/email/send-template",
          "host": ["{{base_url}}"],
          "path": ["api", "email", "send-template"]
        },
        "description": "Testa template de email de dep√≥sito confirmado"
      },
      "response": []
    },
    {
      "name": "üí∏ Test Withdrawal Completed Email",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{access_token}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"template\": \"withdrawal-completed\",\n  \"to\": \"{{test_email}}\",\n  \"data\": {\n    \"name\": \"Jo√£o Silva\",\n    \"amount\": \"50.00\",\n    \"fee\": \"2.50\",\n    \"netAmount\": \"47.50\",\n    \"pixKey\": \"***@gmail.com\",\n    \"transactionId\": \"WTH123456789\",\n    \"timestamp\": \"2024-08-19 17:30:00\"\n  }\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/email/send-template",
          "host": ["{{base_url}}"],
          "path": ["api", "email", "send-template"]
        },
        "description": "Testa template de email de saque completado"
      },
      "response": []
    },
    {
      "name": "üîí Test Password Reset Email",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{access_token}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"template\": \"password-reset\",\n  \"to\": \"{{test_email}}\",\n  \"data\": {\n    \"name\": \"Jo√£o Silva\",\n    \"resetLink\": \"https://app.coinage.com/reset-password?token=abc123\",\n    \"expiryTime\": \"24 horas\"\n  }\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/email/send-template",
          "host": ["{{base_url}}"],
          "path": ["api", "email", "send-template"]
        },
        "description": "Testa template de email de recupera√ß√£o de senha"
      },
      "response": []
    },
    {
      "name": "üìã List Available Templates",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{access_token}}"
          }
        ],
        "url": {
          "raw": "{{base_url}}/api/email/templates",
          "host": ["{{base_url}}"],
          "path": ["api", "email", "templates"]
        },
        "description": "Lista todos os templates de email dispon√≠veis"
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response has templates list\", function () {",
              "    const response = pm.response.json();",
              "    pm.expect(response).to.have.property('success');",
              "    pm.expect(response.data).to.have.property('templates');",
              "    pm.expect(response.data.templates).to.be.an('array');",
              "});",
              "",
              "console.log('‚úÖ Available Templates:', pm.response.json().data?.templates?.length || 0);"
            ],
            "type": "text/javascript"
          }
        }
      ]
    }
  ]
}